<link rel="stylesheet" type="text/css" href="/styles/style.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<html>

<section name="musicAutoplayer">
  <div class="music">
    <p>Currently playing:<br></p>
    <p id="currentlyPlaying">Night in kyoto by AVBE</p>
    <audio autoplay="true" id="player" src="/Itsamesamir.github.io/music/night-in-kyoto-avbe-main-version-21302-01-57.mp3"></audio>
  <div class="musicButtons">
    <button class="musicButtons" value="backwards" onclick="songToggle(this)"><i
        class="fa-solid fa-backward-step fa-beat-fade fa-2xl" style="color: #d59b7c;"></i></button>
    <button class="musicButtons" id="playButton"value="play" onclick="songStatus(this)"><i class="fa-solid fa-play fa-beat-fade fa-2xl"
        style="color: #d59b7c;"></i></button>
    <button class="musicButtons" value="forwards" onclick="songToggle(this)"><i
        class="fa-solid fa-forward-step fa-beat-fade fa-2xl" style="color: #d59b7c;"></i></button>
  </div>
  </div>
</section>

</html>




<script>
  var songCounter = 1

  function getSeason(){
    var date = new Date();
    var month = date.getMonth()
    const months = [[12 , 1 , 2], [3 , 4 , 5],
             [6 , 7 , 8], [9 , 10 , 11]]

    if(months[0].includes(month)){
      return "winter"
    }
    else if(months[1].includes(month)){
      return "spring"
    }
    else if(months[2].includes(month)){
      return "summer"
    }
    else{
      return "autumn"
    }
  }
  
  
  async function getWeather() {
    
    APIURL = "https://api.open-meteo.com/v1/forecast?latitude=51.53&longitude=0.11&hourly=temperature_2m,rain,cloudcover&current_weather=true&forecast_days=1";
    const response = await fetch(APIURL);
    const weatherObj = await response.json();
    
    return weatherObj

  }


  async function setWallpaper() {
    var season = getSeason()
    var weather = await getWeather()
    var currentWeatherCode = weather.current_weather.weathercode
    
    console.log(season)
    //1=daylight,0=night
    var dayTime = weather.current_weather.is_day
    //lists code ->clear, rain, cloudy/gloomy,snow
    var weatherCodes = [[0,1,2],[51,53,55,56,57,61,63,65,66,67,80,81,82,95,96,99],[3,45,48],[71,73,75,77,85,86]]
    if(weatherCodes[0].includes(currentWeatherCode)){
      if(season=="spring"||season=="autumn"){
        if(dayTime==1){
          
          document.body.style.backgroundImage ="url('/Itsamesamir.github.io/images/autumnSunny.png')"
        }
        else{
          document.body.style.backgroundImage = "url('/Itsamesamir.github.io/images/autumnEvening.png')"
        }
        
      }
      else if(season=="summer"){
        if(dayTime==1){
          document.body.style.backgroundImage = "/Itsamesamir.github.io/images/summerSunny.png"
        }
        else{
          document.body.style.backgroundImage = "/Itsamesamir.github.io/images/summerEvening.png"
        }
      }
      else{
        if(dayTime==1){
          document.body.style.backgroundImage = "/Itsamesamir.github.io/images/winterSunny.png"
        }
        else{
          document.body.style.backgroundImage = "/Itsamesamir.github.io/images/winterEvening.png"
        }
      }
    }
    else if(weatherCodes[1].includes(currentWeatherCode)){
      if(season=="spring"||season=="autumn"){
       
        document.body.style.backgroundImage = "/Itsamesamir.github.io/images/autumnRaining.png"
      }
      else if(season=="summer"){
        document.body.style.backgroundImage = "/Itsamesamir.github.io/images/summerRaining.png"
      }
      else{
        document.body.style.backgroundImage = "/Itsamesamir.github.io/images/winterRaining.png"
      }
    }
    else if(weatherCodes[2].includes(currentWeatherCode)){
      if(season=="spring"||season=="autumn"){
        
        document.body.style.backgroundImage = "/Itsamesamir.github.io/images/autumnGloomy.png"
      }
      else if(season=="summer"){
        document.body.style.backgroundImage = "/Itsamesamir.github.io/images/summerGloomy.png"
      }
      else{
        document.body.style.backgroundImage = "/Itsamesamir.github.io/images/winterGloomy.png"
      }
    }
    else{
      document.body.style.backgroundImage = "/Itsamesamir.github.io/images/winterSnowing.png"
    }
  }


  function songStatus(button) {
    
    if(button.value=="play"){
      button.value="pause"
      document.getElementById('player').pause()
    }
    else{
      button.value="play"
      document.getElementById('player').play()
    }
    
  }
 
  
  function songToggle(toggle) {
    //sets values for the songs
    if (toggle.value == "backwards" && songCounter == 1) {
      //this will make sure the songs are looped
      songCounter = 3
    }
    else if (toggle.value == "backwards") {
      songCounter -= 1
    }
    else {
      songCounter += 1
    }
    //change song based on the value
    song = document.getElementById("player")
    songText = document.getElementById("currentlyPlaying")
    if (songCounter % 3 == 1) {
      songText.innerHTML  = "Night in kyoto by AVBE"
      song.src = "/Itsamesamir.github.io/music/night-in-kyoto-avbe-main-version-21302-01-57.mp3"
    }
    else if (songCounter % 3 == 2) {
      songText.innerHTML  = "Early morning by Matrika"
      song.src = "/Itsamesamir.github.io/music/early-morning-matrika-main-version-22092-02-25.mp3"
    }
    else {
      songText.innerHTML  = "Satie by Oliver Massa"
      song.src = "/Itsamesamir.github.io/music/satie-oliver-massa-main-version-13820-02-42.mp3"
    }

  }


  setWallpaper();
</script>
